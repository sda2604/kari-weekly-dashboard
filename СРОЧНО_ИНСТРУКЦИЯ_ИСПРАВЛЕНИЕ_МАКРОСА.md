# üîß –°–†–û–ß–ù–û–ï –ò–°–ü–†–ê–í–õ–ï–ù–ò–ï OUTLOOK –ú–ê–ö–†–û–°–ê

## üî¥ –ü–†–û–ë–õ–ï–ú–ê
Outlook VBA –º–∞–∫—Ä–æ—Å v5.0 **–ù–ï –ª–æ–≤–∏—Ç –ø–∏—Å—å–º–∞** –∏–∑-–∑–∞ –ø—Ä–æ–±–ª–µ–º—ã —Å –∫–æ–¥–∏—Ä–æ–≤–∫–æ–π Subject.

**–ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç:**
- –ü–∏—Å—å–º–∞ –ø—Ä–∏—Ö–æ–¥—è—Ç ‚úÖ
- –ú–∞–∫—Ä–æ—Å –ø–æ–ª—É—á–∞–µ—Ç —Å–æ–±—ã—Ç–∏–µ ‚úÖ  
- Subject —á–∏—Ç–∞–µ—Ç—Å—è –∫–∞–∫ –∫—Ä–∞–∫–æ–∑—è–±—Ä—ã ‚ùå
- `CyrInStr()` –Ω–µ –Ω–∞—Ö–æ–¥–∏—Ç –∫–ª—é—á–µ–≤—ã–µ —Å–ª–æ–≤–∞ ‚ùå
- –§–∞–π–ª—ã –ù–ï —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è ‚ùå

**–ü—Ä–∏–º–µ—Ä –∏–∑ –ª–æ–≥–∞:**
```
Subject: ÔøΩÔøΩÔøΩÔøΩÔøΩ ÔøΩÔøΩ ÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩ ÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩ ÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩ ÔøΩÔøΩ ÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩ ÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩ ÔøΩÔøΩ ÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩ ÔøΩÔøΩÔøΩ ÔøΩÔøΩ 01.02.2026
MATCH: NO - skipped
```

---

## ‚úÖ –†–ï–®–ï–ù–ò–ï: –ú–∞–∫—Ä–æ—Å v6.0

**–ß–¢–û –ò–°–ü–†–ê–í–õ–ï–ù–û:**
- –î–æ–±–∞–≤–ª–µ–Ω–∞ —Ñ—É–Ω–∫—Ü–∏—è `GetSubjectSafe()` - –∏—Å–ø–æ–ª—å–∑—É–µ—Ç PropertyAccessor –¥–ª—è –ø—Ä–∞–≤–∏–ª—å–Ω–æ–π –∫–æ–¥–∏—Ä–æ–≤–∫–∏
- 3 –º–µ—Ç–æ–¥–∞ —á—Ç–µ–Ω–∏—è Subject —Å fallback
- –¢–µ–ø–µ—Ä—å –∫–∏—Ä–∏–ª–ª–∏—Ü–∞ —á–∏—Ç–∞–µ—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ!

---

## üìù –ö–ê–ö –£–°–¢–ê–ù–û–í–ò–¢–¨ (5 –º–∏–Ω—É—Ç)

### –®–ê–ì 1: –û—Ç–∫—Ä–æ–π VBA —Ä–µ–¥–∞–∫—Ç–æ—Ä –≤ Outlook
1. –ó–∞–ø—É—Å—Ç–∏ Outlook
2. –ù–∞–∂–º–∏ `Alt + F11` (–æ—Ç–∫—Ä–æ–µ—Ç—Å—è VBA —Ä–µ–¥–∞–∫—Ç–æ—Ä)
3. –í –ª–µ–≤–æ–π –ø–∞–Ω–µ–ª–∏ –Ω–∞–π–¥–∏ `ThisOutlookSession`
4. –î–≤–∞–∂–¥—ã –∫–ª–∏–∫–Ω–∏ –Ω–∞ –Ω–µ–≥–æ

### –®–ê–ì 2: –ó–∞–º–µ–Ω–∏ –∫–æ–¥
1. **–£–¥–∞–ª–∏ –í–°–Å** —á—Ç–æ –µ—Å—Ç—å –≤ –æ–∫–Ω–µ –∫–æ–¥–∞ (–≤—ã–¥–µ–ª–∏ –≤—Å—ë `Ctrl+A`, —É–¥–∞–ª–∏ `Del`)
2. –û—Ç–∫—Ä–æ–π —Ñ–∞–π–ª: `OUTLOOK_VBA_v6_ENCODING_FIX.txt`
3. –°–∫–æ–ø–∏—Ä—É–π **–í–°–Å** —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ —Ñ–∞–π–ª–∞
4. –í—Å—Ç–∞–≤—å –≤ –æ–∫–Ω–æ VBA (`Ctrl+V`)

### –®–ê–ì 3: –°–æ—Ö—Ä–∞–Ω–∏ –∏ –ø–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏
1. –ù–∞–∂–º–∏ `Ctrl + S` (—Å–æ—Ö—Ä–∞–Ω–∏—Ç—å)
2. –ó–∞–∫—Ä–æ–π VBA —Ä–µ–¥–∞–∫—Ç–æ—Ä
3. **–ó–∞–∫—Ä–æ–π Outlook –ü–û–õ–ù–û–°–¢–¨–Æ** (–§–∞–π–ª ‚Üí –í—ã—Ö–æ–¥)
4. –ó–∞–ø—É—Å—Ç–∏ Outlook –∑–∞–Ω–æ–≤–æ

---

## üß™ –¢–ï–°–¢ –ú–ê–ö–†–û–°–ê

### –í–∞—Ä–∏–∞–Ω—Ç –ê: –¢–µ—Å—Ç —Ñ—É–Ω–∫—Ü–∏–π (–±–µ–∑ –ø–∏—Å–µ–º)
1. –û—Ç–∫—Ä–æ–π VBA —Ä–µ–¥–∞–∫—Ç–æ—Ä (`Alt + F11`)
2. –ù–∞–∂–º–∏ `F5` (Run)
3. –í—ã–±–µ—Ä–∏ `TestMacro`
4. –î–æ–ª–∂–Ω–æ –ø–æ–∫–∞–∑–∞—Ç—å:
   ```
   OK: –û–±—É–≤—å –æ—Å—Ç–∞—Ç–∫–∏ –∏ –æ–±–æ—Ä–∞—á–∏–≤–∞–µ–º–æ—Å—Ç—å –ø–æ –≥—Ä—É–ø–ø–∞–º —Ç–æ–≤–∞—Ä–∞ -> TURNOVER
   OK: –û—Ç—á–µ—Ç –ø–æ –ø—Ä–∏—Ä–æ—Å—Ç—É —Ä–µ–≥–∏–æ–Ω—ã -> REGIONS
   OK: –û—Ç—á–µ—Ç –ø–æ –ø—Ä–∏—Ä–æ—Å—Ç—É –∞–∫—Å–µ—Å—Å—É–∞—Ä–æ–≤ –ø–æ –º–∞–≥–∞–∑–∏–Ω–∞–º -> ACCESSORIES
   ```

### –í–∞—Ä–∏–∞–Ω—Ç –ë: –°–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ—á—Ç—ã (—Å –ø–∏—Å—å–º–∞–º–∏)
1. –û—Ç–∫—Ä–æ–π VBA —Ä–µ–¥–∞–∫—Ç–æ—Ä (`Alt + F11`)
2. –ù–∞–∂–º–∏ `F5` (Run)
3. –í—ã–±–µ—Ä–∏ `ScanInbox`
4. –£–≤–∏–¥–∏—à—å –ø–æ—Å–ª–µ–¥–Ω–∏–µ 10 –ø–∏—Å–µ–º
5. **–í–ê–ñ–ù–û:** –ü—Ä–æ–≤–µ—Ä—å —á—Ç–æ Subject —Ç–µ–ø–µ—Ä—å —á–∏—Ç–∞–µ—Ç—Å—è –ë–ï–ó –∫—Ä–∞–∫–æ–∑—è–±—Ä!
6. –ü—Ä–æ–≤–µ—Ä—å —á—Ç–æ –Ω—É–∂–Ω—ã–µ –ø–∏—Å—å–º–∞ –ø–æ–º–µ—á–µ–Ω—ã –∫–∞–∫ `>>> MATCH [...]`

---

## üìß –†–£–ß–ù–û–ï –°–û–•–†–ê–ù–ï–ù–ò–ï –§–ê–ô–õ–û–í (–Ω–∞ —Å–µ–≥–æ–¥–Ω—è)

–ü–æ–∫–∞ –º–∞–∫—Ä–æ—Å –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω, —Å–æ—Ö—Ä–∞–Ω–∏ —Ñ–∞–π–ª—ã –≤—Ä—É—á–Ω—É—é:

### 1. –ù–∞–π–¥–∏ –ø–∏—Å—å–º–∞ –≤ Outlook
–ò—â–∏ –ø–∏—Å—å–º–∞ —Å —Ç–µ–º–∞–º–∏:
- "–û—Ç—á–µ—Ç –ø–æ –ø—Ä–∏—Ä–æ—Å—Ç—É —Ä–µ–≥–∏–æ–Ω—ã" (–¥–æ–ª–∂–Ω–æ –±—ã—Ç—å 8+ —Ñ–∞–π–ª–æ–≤)
- "–û—Ç—á–µ—Ç –ø–æ –ø—Ä–∏—Ä–æ—Å—Ç—É –∞–∫—Å–µ—Å—Å—É–∞—Ä–æ–≤ –ø–æ –º–∞–≥–∞–∑–∏–Ω–∞–º" (–¥–æ–ª–∂–Ω–æ –±—ã—Ç—å 2+ —Ñ–∞–π–ª–∞)
- "–û–±—É–≤—å –æ—Å—Ç–∞—Ç–∫–∏ –∏ –æ–±–æ—Ä–∞—á–∏–≤–∞–µ–º–æ—Å—Ç—å –ø–æ –≥—Ä—É–ø–ø–∞–º —Ç–æ–≤–∞—Ä–∞" (–¥–æ–ª–∂–µ–Ω –±—ã—Ç—å 1 —Ñ–∞–π–ª)

### 2. –°–æ—Ö—Ä–∞–Ω–∏ Excel —Ñ–∞–π–ª—ã

**–ü–∏—Å—å–º–æ 1:**
- –û—Ç–∫—Ä–æ–π –ø–∏—Å—å–º–æ "–û—Ç—á–µ—Ç –ø–æ –ø—Ä–∏—Ä–æ—Å—Ç—É —Ä–µ–≥–∏–æ–Ω—ã"
- –°–æ—Ö—Ä–∞–Ω–∏ —Ñ–∞–π–ª `–ü–æ —Ä–µ–≥–∏–æ–Ω–∞–º.xlsx` –≤:
  ```
  C:\Users\salni\Desktop\–î–∞–Ω–Ω—ã–µ –¥–ª—è Claude\WORK\2025-01-22_–ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è_–µ–∂–µ–Ω–µ–¥–µ–ª—å–Ω—ã—Ö_–æ—Ç—á–µ—Ç–æ–≤\input\–û—Ç—á–µ—Ç –ø–æ –ø—Ä–∏—Ä–æ—Å—Ç—É —Ä–µ–≥–∏–æ–Ω—ã\
  ```

**–ü–∏—Å—å–º–æ 2:**
- –û—Ç–∫—Ä–æ–π –ø–∏—Å—å–º–æ "–û—Ç—á–µ—Ç –ø–æ –ø—Ä–∏—Ä–æ—Å—Ç—É –∞–∫—Å–µ—Å—Å—É–∞—Ä–æ–≤ –ø–æ –º–∞–≥–∞–∑–∏–Ω–∞–º"
- –°–æ—Ö—Ä–∞–Ω–∏ —Ñ–∞–π–ª `–†–∞—Å—Å—ã–ª–∫–∞ –∞–∫—Å–µ—Å—Å—É–∞—Ä—ã –º–∞–≥–∞–∑–∏–Ω—ã.xlsx` –≤:
  ```
  C:\Users\salni\Desktop\–î–∞–Ω–Ω—ã–µ –¥–ª—è Claude\WORK\2025-01-22_–ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è_–µ–∂–µ–Ω–µ–¥–µ–ª—å–Ω—ã—Ö_–æ—Ç—á–µ—Ç–æ–≤\input\–û—Ç—á–µ—Ç –ø–æ –ø—Ä–∏—Ä–æ—Å—Ç—É –∞–∫—Å–µ—Å—Å—É–∞—Ä–æ–≤ –ø–æ –º–∞–≥–∞–∑–∏–Ω–∞–º\
  ```

**–ü–∏—Å—å–º–æ 3:**
- –û—Ç–∫—Ä–æ–π –ø–∏—Å—å–º–æ "–û–±—É–≤—å –æ—Å—Ç–∞—Ç–∫–∏ –∏ –æ–±–æ—Ä–∞—á–∏–≤–∞–µ–º–æ—Å—Ç—å –ø–æ –≥—Ä—É–ø–ø–∞–º —Ç–æ–≤–∞—Ä–∞"
- –°–æ—Ö—Ä–∞–Ω–∏ —Ñ–∞–π–ª `–û—Ç—á–µ—Ç –ø–æ –æ–±–æ—Ä–∞—á–∏–≤–∞–µ–º–æ—Å—Ç–∏ –¢–ó —Ä–µ–≥–∏–æ–Ω –ù–ù–í.xlsx` –≤:
  ```
  C:\Users\salni\Desktop\–î–∞–Ω–Ω—ã–µ –¥–ª—è Claude\WORK\2025-01-22_–ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è_–µ–∂–µ–Ω–µ–¥–µ–ª—å–Ω—ã—Ö_–æ—Ç—á–µ—Ç–æ–≤\input\–û–±—É–≤—å –æ—Å—Ç–∞—Ç–∫–∏ –∏ –æ–±–æ—Ä–∞—á–∏–≤–∞–µ–º–æ—Å—Ç—å –ø–æ –≥—Ä—É–ø–ø–∞–º —Ç–æ–≤–∞—Ä–∞\
  ```

### 3. –ó–∞–ø—É—Å—Ç–∏ pipeline –≤—Ä—É—á–Ω—É—é
```
C:\Users\salni\Desktop\–î–∞–Ω–Ω—ã–µ –¥–ª—è Claude\WORK\2025-01-22_–ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è_–µ–∂–µ–Ω–µ–¥–µ–ª—å–Ω—ã—Ö_–æ—Ç—á–µ—Ç–æ–≤\run_full_pipeline.bat
```

–î–∞—à–±–æ—Ä–¥ —Å–≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç—Å—è —Å–æ —Å–≤–µ–∂–∏–º–∏ –¥–∞–Ω–Ω—ã–º–∏ –∏ –æ—Ç–ø—Ä–∞–≤–∏—Ç—Å—è –≤ Telegram!

---

## üéØ –ü–†–û–í–ï–†–ö–ê –ü–û–°–õ–ï –£–°–¢–ê–ù–û–í–ö–ò

### –í —Å–ª–µ–¥—É—é—â–∏–π –ø–æ–Ω–µ–¥–µ–ª—å–Ω–∏–∫:
1. –ñ–¥–∏ –ø–∏—Å—å–º–∞ (–æ–±—ã—á–Ω–æ –ø—Ä–∏—Ö–æ–¥—è—Ç —É—Ç—Ä–æ–º)
2. –ü—Ä–æ–≤–µ—Ä—å –ª–æ–≥:
   ```
   logs\outlook_macro_YYYYMMDD.log
   ```
3. –î–æ–ª–∂–Ω–æ –±—ã—Ç—å:
   ```
   Subject: –û—Ç—á–µ—Ç –ø–æ –ø—Ä–∏—Ä–æ—Å—Ç—É —Ä–µ–≥–∏–æ–Ω—ã (–ë–ï–ó –∫—Ä–∞–∫–æ–∑—è–±—Ä!)
   MATCH: YES - REGIONS
   SAVED: –ü–æ —Ä–µ–≥–∏–æ–Ω–∞–º.xlsx
   ```

### –ï—Å–ª–∏ –ø—Ä–æ–±–ª–µ–º–∞ –ø–æ–≤—Ç–æ—Ä–∏—Ç—Å—è:
- –û—Ç–∫—Ä–æ–π VBA —Ä–µ–¥–∞–∫—Ç–æ—Ä (`Alt + F11`)
- –ó–∞–ø—É—Å—Ç–∏ `ScanInbox` (`F5`)
- –°–∫–æ–ø–∏—Ä—É–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç
- –ü–æ–∫–∞–∂–∏ –º–Ω–µ - —Ä–∞–∑–±–µ—Ä—ë–º—Å—è –¥–∞–ª—å—à–µ

---

## üìä –ß–¢–û –ò–ó–ú–ï–ù–ò–õ–û–°–¨ –í v6.0

### –ë–´–õ–û (v5.0):
```vba
strSubject = objMail.Subject  ' ‚Üê –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –∫—Ä–∞–∫–æ–∑—è–±—Ä—ã!
```

### –°–¢–ê–õ–û (v6.0):
```vba
' –§—É–Ω–∫—Ü–∏—è GetSubjectSafe —Å 3 –º–µ—Ç–æ–¥–∞–º–∏:
' 1. PropertyAccessor (—Å–∞–º—ã–π –Ω–∞–¥—ë–∂–Ω—ã–π –¥–ª—è –∫–æ–¥–∏—Ä–æ–≤–∫–∏)
' 2. ConversationTopic (fallback)
' 3. Subject (–ø–æ—Å–ª–µ–¥–Ω–∏–π —à–∞–Ω—Å)
strSubject = GetSubjectSafe(objMail)  ' ‚Üê –ü—Ä–∞–≤–∏–ª—å–Ω–∞—è –∫–æ–¥–∏—Ä–æ–≤–∫–∞!
```

---

## ‚ùì FAQ

**Q: –ü–æ—á–µ–º—É —ç—Ç–æ —Å–ª—É—á–∏–ª–æ—Å—å?**
A: VBA –∏–Ω–æ–≥–¥–∞ —á–∏—Ç–∞–µ—Ç Subject –≤ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ–π –∫–æ–¥–∏—Ä–æ–≤–∫–µ (–æ—Å–æ–±–µ–Ω–Ω–æ –¥–ª—è –∫–∏—Ä–∏–ª–ª–∏—Ü—ã). PropertyAccessor —Ä–µ—à–∞–µ—Ç —ç—Ç—É –ø—Ä–æ–±–ª–µ–º—É.

**Q: –ú–æ–∂–Ω–æ –ª–∏ –Ω–µ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞—Ç—å Outlook?**
A: –ù–µ—Ç, –Ω—É–∂–µ–Ω –ø–æ–ª–Ω—ã–π –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫ –¥–ª—è –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è –Ω–æ–≤–æ–≥–æ –∫–æ–¥–∞.

**Q: –ß—Ç–æ –µ—Å–ª–∏ –º–∞–∫—Ä–æ—Å —Å–Ω–æ–≤–∞ –Ω–µ —Å—Ä–∞–±–æ—Ç–∞–µ—Ç?**
A: –ó–∞–ø—É—Å—Ç–∏ `ScanInbox` –∏ –ø–æ–∫–∞–∂–∏ –º–Ω–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç - –≤–æ–∑–º–æ–∂–Ω–æ –Ω—É–∂–Ω–∞ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞.

**Q: –ù—É–∂–Ω–æ –ª–∏ –∑–∞–Ω–æ–≤–æ –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞—Ç—å Task Scheduler?**
A: –ù–µ—Ç, Task Scheduler –∑–∞–ø—É—Å–∫–∞–µ—Ç `run_full_pipeline.bat`, –∫–æ—Ç–æ—Ä—ã–π –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Ñ–∞–π–ª—ã –∏–∑ `input/`. –ú–∞–∫—Ä–æ—Å —Ç–æ–ª—å–∫–æ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç —Ñ–∞–π–ª—ã —Ç—É–¥–∞.

---

**–í–µ—Ä—Å–∏—è:** 1.0  
**–î–∞—Ç–∞:** 03.02.2026  
**–ê–≤—Ç–æ—Ä:** Claude –¥–ª—è KARI Dashboard Project
