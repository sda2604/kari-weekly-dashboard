#!/bin/bash
# –°–∫—Ä–∏–ø—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –≤–µ—Ä—Å–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è –¥–∞—à–±–æ—Ä–¥–∞ KARI
# –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ: bash update_dashboard.sh

OUTPUT_DIR="C:\Users\salni\Desktop\–î–∞–Ω–Ω—ã–µ –¥–ª—è Claude\WORK\2025-01-22_–ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è_–µ–∂–µ–Ω–µ–¥–µ–ª—å–Ω—ã—Ö_–æ—Ç—á–µ—Ç–æ–≤\output"
ARCHIVE_DIR="C:\Users\salni\Desktop\–î–∞–Ω–Ω—ã–µ –¥–ª—è Claude\WORK\2025-01-22_–ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è_–µ–∂–µ–Ω–µ–¥–µ–ª—å–Ω—ã—Ö_–æ—Ç—á–µ—Ç–æ–≤\output\archive"
CURRENT="dashboard_current.html"

echo "üîÑ –°–∏—Å—Ç–µ–º–∞ –≤–µ—Ä—Å–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è –¥–∞—à–±–æ—Ä–¥–∞ KARI"
echo "=========================================="

# –°–æ–∑–¥–∞—Ç—å archive –µ—Å–ª–∏ –Ω–µ—Ç
mkdir -p "$ARCHIVE_DIR"
echo "‚úÖ –ü–∞–ø–∫–∞ –∞—Ä—Ö–∏–≤–∞ –≥–æ—Ç–æ–≤–∞: $ARCHIVE_DIR"

# –ï—Å–ª–∏ —Ç–µ–∫—É—â–∏–π –¥–∞—à–±–æ—Ä–¥ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç - –ø–µ—Ä–µ–º–µ—Å—Ç–∏—Ç—å –≤ –∞—Ä—Ö–∏–≤
if [ -f "$OUTPUT_DIR/$CURRENT" ]; then
    TIMESTAMP=$(date +"%Y-%m-%d_%H-%M")
    mv "$OUTPUT_DIR/$CURRENT" "$ARCHIVE_DIR/$TIMESTAMP.html"
    echo "‚úÖ –°—Ç–∞—Ä–∞—è –≤–µ—Ä—Å–∏—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∞: archive/$TIMESTAMP.html"
else
    echo "‚ÑπÔ∏è  –¢–µ–∫—É—â–µ–≥–æ –¥–∞—à–±–æ—Ä–¥–∞ –Ω–µ—Ç (–ø–µ—Ä–≤—ã–π –∑–∞–ø—É—Å–∫)"
fi

# –£–¥–∞–ª–∏—Ç—å —Å—Ç–∞—Ä—ã–µ –≤–µ—Ä—Å–∏–∏ (–æ—Å—Ç–∞–≤–∏—Ç—å —Ç–æ–ª—å–∫–æ 10 –ø–æ—Å–ª–µ–¥–Ω–∏—Ö)
cd "$ARCHIVE_DIR"
FILE_COUNT=$(ls -1 *.html 2>/dev/null | wc -l)
if [ "$FILE_COUNT" -gt 10 ]; then
    REMOVED=$((FILE_COUNT - 10))
    ls -t *.html | tail -n +11 | xargs rm
    echo "‚úÖ –ê—Ä—Ö–∏–≤ –æ—á–∏—â–µ–Ω (—É–¥–∞–ª–µ–Ω–æ $REMOVED —Å—Ç–∞—Ä—ã—Ö –≤–µ—Ä—Å–∏–π)"
else
    echo "‚ÑπÔ∏è  –í –∞—Ä—Ö–∏–≤–µ $FILE_COUNT –≤–µ—Ä—Å–∏–π (–ª–∏–º–∏—Ç 10)"
fi

echo "=========================================="
echo "‚úÖ –ì–æ—Ç–æ–≤–æ! –¢–µ–ø–µ—Ä—å —Å–æ–∑–¥–∞–≤–∞–π –Ω–æ–≤—ã–π dashboard_current.html"
echo ""
